{"ast":null,"code":"import _objectSpread from\"C:/Users/PC/OneDrive/Desktop/React/social-network/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/PC/OneDrive/Desktop/React/social-network/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./profile.css\";import Header from\"../Header/header\";import Footer from\"../Footer/footer\";import{useEffect,useState}from\"react\";import axios from\"axios\";import{useDispatch}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(props){var token=JSON.parse(localStorage.getItem(\"token\"));var dispatch=useDispatch();var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];useEffect(function(){var id=props.match.params.id;axios.post(\"https://social-network-edin.herokuapp.com/api/users/getprofile\",{userid:id}).then(function(res){if(typeof res.data===\"object\"){setUser(res.data);dispatch({type:\"LOAD\",payload:token.user.posts});}else{console.log(\"User not found.\");}});// eslint-disable-next-line\n},[props.match.params.id]);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),settings=_useState4[0],setSettings=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];if(!user){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading\"});}function follow(id){user.following.push(id);setUser(_objectSpread(_objectSpread({},user),{},{following:user.following}));console.log(user.following);axios.post(\"https://social-network-edin.herokuapp.com/api/users/follow\",{followedID:id,followerID:token.user._id}).then(function(res){if(res.data===\"Followed\"){console.log(\"Extra\");}else{console.log(\"Problem\");}});}function unfollow(id){var update=user.following.filter(function(flw){return flw!==id;});setUser(_objectSpread(_objectSpread({},user),{},{following:update}));axios.post(\"https://social-network-edin.herokuapp.com/api/users/unfollow\",{unfollowedID:id,unfollowerID:token.user._id}).then(function(res){if(res.data===\"Unfollowed\"){console.log(user.following);}else{console.log(\"Problem\");}});}function openFile(e){setFile(e.target.files[0]);console.log(file);}var formdata=new FormData();function updateProfilePhoto(){if(file===undefined){console.log(\"Select one file\");}formdata.append(\"file\",file);formdata.append(\"upload_preset\",\"ml_default\");axios.post(\"https://api.cloudinary.com/v1_1/dyp902luw/image/upload\",formdata).then(function(res){console.log(res.data);});axios.post(\"https://social-network-edin.herokuapp.com/api/posts/updateprofile\",{userid:props.match.params.id,photo:\"https://res.cloudinary.com/dyp902luw/image/upload/v1629370172/\"+file.name}).then(function(res){if(res.data===\"Uploaded\"){console.log(\"uploaded\");}else{console.log(\"Server problem\");}});}function logout(){localStorage.removeItem(\"token\");window.location=\"/login\";}var settingsStyle=settings?{display:\"block\"}:{display:\"none\"};return/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",children:[/*#__PURE__*/_jsxs(\"span\",{id:\"main\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.profilePhoto,alt:\"profile\"}),/*#__PURE__*/_jsx(\"h2\",{children:user.username})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Posts\"}),/*#__PURE__*/_jsx(\"p\",{children:user.posts.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Followers\"}),/*#__PURE__*/_jsx(\"p\",{children:user.followers.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Following\"}),/*#__PURE__*/_jsx(\"p\",{children:user.following.length})]})]})]}),/*#__PURE__*/_jsxs(\"span\",{id:\"btns\",children:[token.user._id===user._id?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setSettings(!settings);},id:\"settings-btn\",children:\"SETTINGS\"}):\"\",user.following.length<=0||!user.following.find(function(id){return id===props.match.params.id;})?/*#__PURE__*/_jsx(\"button\",{id:\"follow-btn\",onClick:function onClick(){return follow(props.match.params.id);},children:\"FOLLOW\"}):/*#__PURE__*/_jsx(\"button\",{id:\"unfollow-btn\",onClick:function onClick(){return unfollow(props.match.params.id);},children:\"UNFOLLOW\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"settings\",style:settingsStyle,children:[/*#__PURE__*/_jsx(\"h4\",{onClick:function onClick(){return logout();},children:\"Logout\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){return openFile(e);}}),/*#__PURE__*/_jsx(\"h4\",{onClick:function onClick(){return updateProfilePhoto();},children:\"UPLOAD\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:user.posts.map(function(photo){return/*#__PURE__*/_jsx(\"img\",{src:photo.photo,alt:\"post\",onClick:function onClick(){return window.location=\"/post/\"+photo._id;}});})}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"sources":["C:/Users/PC/OneDrive/Desktop/React/social-network/client/src/components/Profile/profile.js"],"names":["Header","Footer","useEffect","useState","axios","useDispatch","Profile","props","token","JSON","parse","localStorage","getItem","dispatch","user","setUser","id","match","params","post","userid","then","res","data","type","payload","posts","console","log","settings","setSettings","file","setFile","follow","following","push","followedID","followerID","_id","unfollow","update","filter","flw","unfollowedID","unfollowerID","openFile","e","target","files","formdata","FormData","updateProfilePhoto","undefined","append","photo","name","logout","removeItem","window","location","settingsStyle","display","profilePhoto","username","length","followers","find","map"],"mappings":"6VACA,MAAO,eAAP,CACA,MAAOA,CAAAA,MAAP,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,CACA,OAASC,SAAT,CAAmBC,QAAnB,KAAmC,OAAnC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,WAAT,KAA4B,aAA5B,C,wFAIA,cAAe,SAASC,CAAAA,OAAT,CAAiBC,KAAjB,CAAuB,CAClC,GAAIC,CAAAA,KAAK,CAACC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAX,CAAV,CAGD,GAAIC,CAAAA,QAAQ,CAACR,WAAW,EAAxB,CAEC,cAAoBF,QAAQ,EAA5B,wCAAMW,IAAN,eAAWC,OAAX,eACAb,SAAS,CAAC,UAAI,CACV,GAAIc,CAAAA,EAAE,CAACT,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EAA1B,CACAZ,KAAK,CAACe,IAAN,CAAW,gEAAX,CAA4E,CACxEC,MAAM,CAACJ,EADiE,CAA5E,EAGCK,IAHD,CAGM,SAAAC,GAAG,CAAE,CACP,GAAG,MAAOA,CAAAA,GAAG,CAACC,IAAX,GAAmB,QAAtB,CAA+B,CAC3BR,OAAO,CAACO,GAAG,CAACC,IAAL,CAAP,CACAV,QAAQ,CAAC,CAACW,IAAI,CAAC,MAAN,CAAaC,OAAO,CAACjB,KAAK,CAACM,IAAN,CAAWY,KAAhC,CAAD,CAAR,CACH,CAHD,IAGK,CACDC,OAAO,CAACC,GAAR,CAAY,iBAAZ,EACH,CACJ,CAVD,EAWR;AACK,CAdQ,CAcP,CAACrB,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EAApB,CAdO,CAAT,CAeA,eAA6Bb,QAAQ,CAAC,KAAD,CAArC,yCAAO0B,QAAP,eAAgBC,WAAhB,eACA,eAAqB3B,QAAQ,EAA7B,yCAAO4B,IAAP,eAAYC,OAAZ,eACA,GAAG,CAAClB,IAAJ,CAAS,CACL,mBAAO,gCAAP,CACH,CAED,QAASmB,CAAAA,MAAT,CAAgBjB,EAAhB,CAAmB,CACfF,IAAI,CAACoB,SAAL,CAAeC,IAAf,CAAoBnB,EAApB,EAEAD,OAAO,gCAAKD,IAAL,MAAUoB,SAAS,CAACpB,IAAI,CAACoB,SAAzB,GAAP,CACAP,OAAO,CAACC,GAAR,CAAYd,IAAI,CAACoB,SAAjB,EACA9B,KAAK,CAACe,IAAN,CAAW,4DAAX,CAAwE,CACpEiB,UAAU,CAACpB,EADyD,CAEpEqB,UAAU,CAAC7B,KAAK,CAACM,IAAN,CAAWwB,GAF8C,CAAxE,EAICjB,IAJD,CAIM,SAAAC,GAAG,CAAE,CACP,GAAGA,GAAG,CAACC,IAAJ,GAAW,UAAd,CAAyB,CACrBI,OAAO,CAACC,GAAR,CAAY,OAAZ,EACH,CAFD,IAEK,CACDD,OAAO,CAACC,GAAR,CAAY,SAAZ,EACH,CACJ,CAVD,EAWH,CAED,QAASW,CAAAA,QAAT,CAAkBvB,EAAlB,CAAqB,CACjB,GAAIwB,CAAAA,MAAM,CAAC1B,IAAI,CAACoB,SAAL,CAAeO,MAAf,CAAsB,SAAAC,GAAG,QAAEA,CAAAA,GAAG,GAAG1B,EAAR,EAAzB,CAAX,CACAD,OAAO,gCAAKD,IAAL,MAAUoB,SAAS,CAACM,MAApB,GAAP,CACApC,KAAK,CAACe,IAAN,CAAW,8DAAX,CAA0E,CACtEwB,YAAY,CAAC3B,EADyD,CAEtE4B,YAAY,CAACpC,KAAK,CAACM,IAAN,CAAWwB,GAF8C,CAA1E,EAICjB,IAJD,CAIM,SAAAC,GAAG,CAAE,CACP,GAAGA,GAAG,CAACC,IAAJ,GAAW,YAAd,CAA2B,CAEvBI,OAAO,CAACC,GAAR,CAAYd,IAAI,CAACoB,SAAjB,EACH,CAHD,IAGK,CACDP,OAAO,CAACC,GAAR,CAAY,SAAZ,EACH,CACJ,CAXD,EAYH,CAED,QAASiB,CAAAA,QAAT,CAAkBC,CAAlB,CAAoB,CAChBd,OAAO,CAACc,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAP,CACArB,OAAO,CAACC,GAAR,CAAYG,IAAZ,EAEH,CAED,GAAMkB,CAAAA,QAAQ,CAAC,GAAIC,CAAAA,QAAJ,EAAf,CAEA,QAASC,CAAAA,kBAAT,EAA6B,CACzB,GAAGpB,IAAI,GAAGqB,SAAV,CAAoB,CAChBzB,OAAO,CAACC,GAAR,CAAY,iBAAZ,EACH,CAEDqB,QAAQ,CAACI,MAAT,CAAgB,MAAhB,CAAuBtB,IAAvB,EACAkB,QAAQ,CAACI,MAAT,CAAgB,eAAhB,CAAgC,YAAhC,EACAjD,KAAK,CAACe,IAAN,CAAW,wDAAX,CAAoE8B,QAApE,EAA8E5B,IAA9E,CAAmF,SAAAC,GAAG,CAAE,CACpFK,OAAO,CAACC,GAAR,CAAYN,GAAG,CAACC,IAAhB,EACH,CAFD,EAIAnB,KAAK,CAACe,IAAN,CAAW,mEAAX,CAA+E,CAC3EC,MAAM,CAACb,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EADiD,CAE3EsC,KAAK,CAAC,iEAAiEvB,IAAI,CAACwB,IAFD,CAA/E,EAIClC,IAJD,CAIM,SAAAC,GAAG,CAAE,CACP,GAAGA,GAAG,CAACC,IAAJ,GAAW,UAAd,CAAyB,CACrBI,OAAO,CAACC,GAAR,CAAY,UAAZ,EACH,CAFD,IAEK,CACDD,OAAO,CAACC,GAAR,CAAY,gBAAZ,EACH,CACJ,CAVD,EAWH,CAED,QAAS4B,CAAAA,MAAT,EAAiB,CACb7C,YAAY,CAAC8C,UAAb,CAAwB,OAAxB,EACAC,MAAM,CAACC,QAAP,CAAgB,QAAhB,CACH,CAED,GAAIC,CAAAA,aAAa,CAAC/B,QAAQ,CAAG,CAACgC,OAAO,CAAC,OAAT,CAAH,CAAqB,CAACA,OAAO,CAAC,MAAT,CAA/C,CACA,mBAAO,aAAK,SAAS,CAAC,SAAf,wBACH,KAAC,MAAD,IADG,cAEH,aAAK,SAAS,CAAC,gBAAf,wBACI,aAAK,SAAS,CAAC,cAAf,wBACI,cAAM,EAAE,CAAC,MAAT,wBACI,YAAK,GAAG,CAAE/C,IAAI,CAACgD,YAAf,CAA6B,GAAG,CAAC,SAAjC,EADJ,cAEI,oBAAKhD,IAAI,CAACiD,QAAV,EAFJ,GADJ,cAMI,qCACI,oCACI,6BADJ,cAEI,mBAAIjD,IAAI,CAACY,KAAL,CAAWsC,MAAf,EAFJ,GADJ,cAKI,oCACI,iCADJ,cAEI,mBAAIlD,IAAI,CAACmD,SAAL,CAAeD,MAAnB,EAFJ,GALJ,cASI,oCACI,iCADJ,cAEI,mBAAIlD,IAAI,CAACoB,SAAL,CAAe8B,MAAnB,EAFJ,GATJ,GANJ,GADJ,cAuBI,cAAM,EAAE,CAAC,MAAT,WACKxD,KAAK,CAACM,IAAN,CAAWwB,GAAX,GAAiBxB,IAAI,CAACwB,GAAtB,cAA4B,eAAQ,OAAO,CAAE,yBAAIR,CAAAA,WAAW,CAAC,CAACD,QAAF,CAAf,EAAjB,CAA6C,EAAE,CAAC,cAAhD,sBAA5B,CAA6G,EADlH,CAEKf,IAAI,CAACoB,SAAL,CAAe8B,MAAf,EAAuB,CAAvB,EAA4B,CAAClD,IAAI,CAACoB,SAAL,CAAegC,IAAf,CAAoB,SAAAlD,EAAE,QAAEA,CAAAA,EAAE,GAAGT,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EAA1B,EAAtB,CAA7B,cAAmF,eAAQ,EAAE,CAAC,YAAX,CAAwB,OAAO,CAAE,yBAAIiB,CAAAA,MAAM,CAAC1B,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EAApB,CAAV,EAAjC,oBAAnF,cACD,eAAQ,EAAE,CAAC,cAAX,CAA0B,OAAO,CAAE,yBAAIuB,CAAAA,QAAQ,CAAChC,KAAK,CAACU,KAAN,CAAYC,MAAZ,CAAmBF,EAApB,CAAZ,EAAnC,sBAHJ,GAvBJ,GAFG,cAkCH,aAAK,EAAE,CAAC,UAAR,CAAmB,KAAK,CAAE4C,aAA1B,wBACQ,WAAI,OAAO,CAAE,yBAAIJ,CAAAA,MAAM,EAAV,EAAb,oBADR,cAEQ,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,kBAACV,CAAD,QAAKD,CAAAA,QAAQ,CAACC,CAAD,CAAb,EAA7B,EAFR,cAGQ,WAAI,OAAO,CAAE,yBAAIK,CAAAA,kBAAkB,EAAtB,EAAb,oBAHR,GAlCG,cAuCH,YAAK,SAAS,CAAC,iBAAf,UAEKrC,IAAI,CAACY,KAAL,CAAWyC,GAAX,CAAe,SAAAb,KAAK,CAAE,CAEnB,mBAAO,YAAK,GAAG,CAAEA,KAAK,CAACA,KAAhB,CAAuB,GAAG,CAAC,MAA3B,CAAkC,OAAO,CAAE,yBAAII,CAAAA,MAAM,CAACC,QAAP,CAAgB,SAASL,KAAK,CAAChB,GAAnC,EAA3C,EAAP,CACH,CAHA,CAFL,EAvCG,cAgDH,KAAC,MAAD,IAhDG,GAAP,CAkDH","sourcesContent":["\r\nimport \"./profile.css\";\r\nimport Header from \"../Header/header\";\r\nimport Footer from \"../Footer/footer\";\r\nimport { useEffect,useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport { useDispatch } from \"react-redux\";\r\n\r\n\r\n\r\nexport default function Profile(props){\r\n    let token=JSON.parse(localStorage.getItem(\"token\"));\r\n\r\n\r\n   let dispatch=useDispatch();\r\n\r\n    const[user,setUser]=useState();\r\n    useEffect(()=>{\r\n        let id=props.match.params.id;\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/getprofile\",{\r\n            userid:id\r\n        })\r\n        .then(res=>{\r\n            if(typeof(res.data)===\"object\"){\r\n                setUser(res.data);\r\n                dispatch({type:\"LOAD\",payload:token.user.posts})\r\n            }else{\r\n                console.log(\"User not found.\");\r\n            }\r\n        })\r\n// eslint-disable-next-line\r\n    },[props.match.params.id])\r\n    const [settings,setSettings]=useState(false);\r\n    const [file,setFile]=useState();\r\n    if(!user){\r\n        return <div>Loading</div>\r\n    }\r\n    \r\n    function follow(id){\r\n        user.following.push(id);\r\n                \r\n        setUser({...user,following:user.following});\r\n        console.log(user.following)\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/follow\",{\r\n            followedID:id,\r\n            followerID:token.user._id\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Followed\"){\r\n                console.log(\"Extra\")\r\n            }else{\r\n                console.log(\"Problem\");\r\n            }\r\n        })\r\n    }\r\n\r\n    function unfollow(id){\r\n        let update=user.following.filter(flw=>flw!==id)\r\n        setUser({...user,following:update});\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/unfollow\",{\r\n            unfollowedID:id,\r\n            unfollowerID:token.user._id\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Unfollowed\"){\r\n\r\n                console.log(user.following);\r\n            }else{\r\n                console.log(\"Problem\");\r\n            }\r\n        })\r\n    }\r\n\r\n    function openFile(e){\r\n        setFile(e.target.files[0]);\r\n        console.log(file)\r\n       \r\n    }\r\n\r\n    const formdata=new FormData();\r\n\r\n    function updateProfilePhoto(){\r\n        if(file===undefined){\r\n            console.log(\"Select one file\");\r\n        }\r\n\r\n        formdata.append(\"file\",file);\r\n        formdata.append(\"upload_preset\",\"ml_default\");\r\n        axios.post(\"https://api.cloudinary.com/v1_1/dyp902luw/image/upload\",formdata).then(res=>{\r\n            console.log(res.data)\r\n        });\r\n\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/posts/updateprofile\",{\r\n            userid:props.match.params.id,\r\n            photo:\"https://res.cloudinary.com/dyp902luw/image/upload/v1629370172/\"+file.name\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Uploaded\"){\r\n                console.log(\"uploaded\")\r\n            }else{\r\n                console.log(\"Server problem\");\r\n            }\r\n        })\r\n    }\r\n\r\n    function logout(){\r\n        localStorage.removeItem(\"token\");\r\n        window.location=\"/login\";\r\n    }\r\n\r\n    let settingsStyle=settings ? {display:\"block\"}:{display:\"none\"};\r\n    return <div className=\"profile\">\r\n        <Header/>\r\n        <div className=\"profile-header\">\r\n            <div className=\"profile-info\">\r\n                <span id=\"main\">\r\n                    <img src={user.profilePhoto} alt=\"profile\"/>\r\n                    <h2>{user.username}</h2>\r\n                </span>\r\n                \r\n                <span>\r\n                    <div>\r\n                        <h5>Posts</h5>\r\n                        <p>{user.posts.length}</p>\r\n                    </div>\r\n                    <div>\r\n                        <h5>Followers</h5>\r\n                        <p>{user.followers.length}</p>\r\n                    </div>\r\n                    <div>\r\n                        <h5>Following</h5>\r\n                        <p>{user.following.length}</p>\r\n                    </div>\r\n                </span>\r\n\r\n            </div>\r\n            <span id=\"btns\">\r\n                {token.user._id===user._id ? <button onClick={()=>setSettings(!settings)} id=\"settings-btn\">SETTINGS</button>:\"\"}\r\n                {user.following.length<=0 || !user.following.find(id=>id===props.match.params.id) ? <button id=\"follow-btn\" onClick={()=>follow(props.match.params.id)}>FOLLOW</button>:\r\n                <button id=\"unfollow-btn\" onClick={()=>unfollow(props.match.params.id)}>UNFOLLOW</button>}\r\n            </span>\r\n\r\n\r\n            \r\n        </div>\r\n        <div id=\"settings\" style={settingsStyle} >\r\n                <h4 onClick={()=>logout()}>Logout</h4>\r\n                <input type=\"file\" onChange={(e)=>openFile(e)}/>\r\n                <h4 onClick={()=>updateProfilePhoto()}>UPLOAD</h4>\r\n        </div>\r\n        <div className=\"image-container\">\r\n            \r\n            {user.posts.map(photo=>{\r\n                \r\n                return <img src={photo.photo} alt=\"post\" onClick={()=>window.location=\"/post/\"+photo._id}/>\r\n            })}\r\n                \r\n  \r\n        </div>\r\n        <Footer/>\r\n    </div>\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}