{"ast":null,"code":"import _slicedToArray from\"C:/Users/PC/OneDrive/Desktop/React/social-network/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from\"react\";import{IoAddCircleOutline,IoCloseSharp}from\"react-icons/io5\";import Header from\"../Header/header\";import Footer from\"../Footer/footer\";import axios from\"axios\";import\"./newpost.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function NewPost(){var token=JSON.parse(localStorage.getItem(\"token\"));var user=token.user;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),description=_useState2[0],setDescription=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),alert=_useState6[0],setAlert=_useState6[1];var alertStyle=alert===undefined?{display:\"none\"}:{display:\"block\",color:\"red\"};var openFile=function openFile(file){setFile(file.target.files[0]);var input=file.target;var reader=new FileReader();reader.onload=function(){var dataURL=reader.result;var output=document.getElementById('output');output.src=dataURL;};reader.readAsDataURL(input.files[0]);};var formdata=new FormData();function uploadPhotoInfo(e){if(file===undefined){setAlert(\"Please select 1 picture\");return false;}formdata.append(\"file\",file);formdata.append(\"upload_preset\",\"ml_default\");axios.post(\"https://api.cloudinary.com/v1_1/dyp902luw/image/upload\",formdata).then(function(res){console.log(res.data);});axios.post(\"https://social-network-edin.herokuapp.com/api/posts/uploadpost\",{photo:\"https://res.cloudinary.com/dyp902luw/image/upload/v1629370172/\"+file.name,user:JSON.stringify(user),description:description}).then(function(res){if(res.data===\"Uploaded\"){window.location=\"/home\";}else{setAlert(\"Error:File is not uploaded successfully, try again.\");}});}return/*#__PURE__*/_jsxs(\"div\",{className:\"Newpost\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"photo-upload\",children:[/*#__PURE__*/_jsx(IoAddCircleOutline,{color:\"royalblue\",style:file?{display:\"none\"}:{display:\"block\"}}),/*#__PURE__*/_jsx(IoCloseSharp,{color:\"red\",size:\"32px\",id:\"close\",style:file?{display:\"block\"}:{display:\"none\"},onClick:function onClick(e){return window.location=\"/newpost\";}}),!file?/*#__PURE__*/_jsx(\"input\",{required:true,type:\"file\",onChange:function onChange(e){return openFile(e);}}):/*#__PURE__*/_jsx(\"img\",{id:\"output\",alt:\"Puploadhoto\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"description-upload\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:function onChange(e){return setDescription(e.target.value);},placeholder:\"Type description of yout photo...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return uploadPhotoInfo();},children:\"UPLOAD\"}),/*#__PURE__*/_jsx(\"p\",{style:alertStyle,children:alert})]}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"sources":["C:/Users/PC/OneDrive/Desktop/React/social-network/client/src/components/NewPost/NewPost.js"],"names":["useState","IoAddCircleOutline","IoCloseSharp","Header","Footer","axios","NewPost","token","JSON","parse","localStorage","getItem","user","description","setDescription","file","setFile","alert","setAlert","alertStyle","undefined","display","color","openFile","target","files","input","reader","FileReader","onload","dataURL","result","output","document","getElementById","src","readAsDataURL","formdata","FormData","uploadPhotoInfo","e","append","post","then","res","console","log","data","photo","name","stringify","window","location","value"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\r\nimport {IoAddCircleOutline,IoCloseSharp} from \"react-icons/io5\";\r\nimport Header from \"../Header/header\";\r\nimport Footer from \"../Footer/footer\";\r\n\r\nimport axios from \"axios\";\r\nimport \"./newpost.css\";\r\n\r\nexport default function NewPost(){\r\n    const token=JSON.parse(localStorage.getItem(\"token\"));\r\n    const user=token.user;\r\n\r\n  \r\n\r\n    const [description,setDescription]=useState(\"\")\r\n    const[file,setFile]=useState();\r\n\r\n\r\n\r\n    const [alert,setAlert]=useState();\r\n    const alertStyle=alert===undefined ? {display:\"none\"}:{display:\"block\",color:\"red\"};\r\n  \r\n    var openFile = function(file) {\r\n        setFile(file.target.files[0]);\r\n        var input = file.target;\r\n    \r\n        var reader = new FileReader();\r\n        reader.onload = function(){\r\n          var dataURL = reader.result;\r\n          var output = document.getElementById('output');\r\n          output.src = dataURL;\r\n        };\r\n        reader.readAsDataURL(input.files[0]);\r\n      };\r\n            \r\n    const formdata=new FormData();\r\n\r\n\r\n    function uploadPhotoInfo(e){\r\n        if(file===undefined){\r\n            setAlert(\"Please select 1 picture\");\r\n            return false;\r\n        }\r\n        formdata.append(\"file\",file);\r\n        formdata.append(\"upload_preset\",\"ml_default\")\r\n        axios.post(\"https://api.cloudinary.com/v1_1/dyp902luw/image/upload\",formdata).then(res=>{\r\n            console.log(res.data)\r\n        });\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/posts/uploadpost\",{\r\n            photo:\"https://res.cloudinary.com/dyp902luw/image/upload/v1629370172/\"+file.name,\r\n            user:JSON.stringify(user),\r\n            description:description\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Uploaded\"){\r\n                window.location=\"/home\";\r\n            }else{\r\n                setAlert(\"Error:File is not uploaded successfully, try again.\")\r\n            }\r\n        })\r\n    }\r\n\r\n    return <div className=\"Newpost\">\r\n        <Header/>\r\n        <div className=\"photo-upload\">\r\n            <IoAddCircleOutline color=\"royalblue\" style={file ? {display:\"none\"}:{display:\"block\"}}/>\r\n            <IoCloseSharp color=\"red\" size=\"32px\" id=\"close\" style={file ? {display:\"block\"}:{display:\"none\"}} onClick={e=>window.location=\"/newpost\"}/>\r\n            {!file?<input required type=\"file\" onChange={e=>openFile(e)}/>: <img id=\"output\" alt=\"Puploadhoto\"/>}\r\n           \r\n        </div>\r\n    \t\r\n        <div className=\"description-upload\">\r\n            <textarea value={description} onChange={e=>setDescription(e.target.value)} placeholder=\"Type description of yout photo...\"></textarea>\r\n            <button onClick={()=>uploadPhotoInfo()}>UPLOAD</button>\r\n\r\n            <p style={alertStyle}>{alert}</p>\r\n        </div>\r\n        \r\n        <Footer/>\r\n    </div>\r\n}"]},"metadata":{},"sourceType":"module"}