{"ast":null,"code":"import _objectSpread from\"C:/Users/PC/OneDrive/Desktop/React/social-network/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/PC/OneDrive/Desktop/React/social-network/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{IoMdClose}from\"react-icons/io\";import{useState,useEffect}from\"react\";import axios from\"axios\";import\"./search.css\";import{useSelector}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Search(_ref){var setSearchToggle=_ref.setSearchToggle;var token=JSON.parse(localStorage.getItem(\"token\"));var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];useEffect(function(){var id=token.user._id;axios.post(\"https://social-network-edin.herokuapp.com/api/users/getprofile\",{userid:id}).then(function(res){if(typeof res.data===\"object\"){setUser(res.data);}else{console.log(\"User not found.\");}});},[token.user._id]);var users=useSelector(function(store){return store.search;});function follow(id){user.following.push(id);setUser(_objectSpread(_objectSpread({},user),{},{following:user.following}));console.log(user.following);axios.post(\"https://social-network-edin.herokuapp.com/api/users/follow\",{followedID:id,followerID:token.user._id}).then(function(res){if(res.data===\"Followed\"){console.log(\"Extra\");}else{console.log(\"Problem\");}});}function unfollow(id){var update=user.following.filter(function(flw){return flw!==id;});setUser(_objectSpread(_objectSpread({},user),{},{following:update}));axios.post(\"https://social-network-edin.herokuapp.com/api/users/unfollow\",{unfollowedID:id,unfollowerID:token.user._id}).then(function(res){if(res.data===\"Unfollowed\"){console.log(user.following);}else{console.log(\"Problem\");}});}if(!user){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(IoMdClose,{color:\"red\",size:\"24px\",onClick:function onClick(){return setSearchToggle(false);}}),users.map(function(person){return/*#__PURE__*/_jsxs(\"div\",{className:\"single-user\",children:[/*#__PURE__*/_jsxs(\"span\",{onClick:function onClick(){return window.location=\"/profile/\"+person._id;},children:[/*#__PURE__*/_jsx(\"img\",{src:person.profilePhoto,alt:\"profile\"}),/*#__PURE__*/_jsx(\"h4\",{children:person.username})]}),!user.following.find(function(flw){return flw===person._id;})?/*#__PURE__*/_jsx(\"button\",{id:\"follow-btn\",onClick:function onClick(){return follow(person._id);},children:\"FOLLOW\"}):/*#__PURE__*/_jsx(\"button\",{id:\"unfollow-btn\",onClick:function onClick(){return unfollow(person._id);},children:\"UNFOLLOW\"})]});})]});}","map":{"version":3,"sources":["C:/Users/PC/OneDrive/Desktop/React/social-network/client/src/components/Search/search.js"],"names":["IoMdClose","useState","useEffect","axios","useSelector","Search","setSearchToggle","token","JSON","parse","localStorage","getItem","user","setUser","id","_id","post","userid","then","res","data","console","log","users","store","search","follow","following","push","followedID","followerID","unfollow","update","filter","flw","unfollowedID","unfollowerID","map","person","window","location","profilePhoto","username","find"],"mappings":"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","sourcesContent":["import {IoMdClose} from \"react-icons/io\";\r\nimport { useState,useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./search.css\";\r\nimport {useSelector} from \"react-redux\";\r\n\r\nexport default function Search({setSearchToggle}){\r\n    let token=JSON.parse(localStorage.getItem(\"token\"));\r\n    const[user,setUser]=useState();\r\n    useEffect(()=>{\r\n        let id=token.user._id;\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/getprofile\",{\r\n            userid:id\r\n        })\r\n        .then(res=>{\r\n            if(typeof(res.data)===\"object\"){\r\n                setUser(res.data);\r\n                \r\n            }else{\r\n                console.log(\"User not found.\");\r\n            }\r\n        })\r\n\r\n    },[token.user._id]) \r\n    let users=useSelector(store=>store.search);\r\n\r\n    function follow(id){\r\n        user.following.push(id);\r\n                \r\n        setUser({...user,following:user.following});\r\n        console.log(user.following)\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/follow\",{\r\n            followedID:id,\r\n            followerID:token.user._id\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Followed\"){\r\n                console.log(\"Extra\")\r\n            }else{\r\n                console.log(\"Problem\");\r\n            }\r\n        })\r\n    }\r\n\r\n    function unfollow(id){\r\n        let update=user.following.filter(flw=>flw!==id)\r\n        setUser({...user,following:update});\r\n        axios.post(\"https://social-network-edin.herokuapp.com/api/users/unfollow\",{\r\n            unfollowedID:id,\r\n            unfollowerID:token.user._id\r\n        })\r\n        .then(res=>{\r\n            if(res.data===\"Unfollowed\"){\r\n\r\n                console.log(user.following);\r\n            }else{\r\n                console.log(\"Problem\");\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if(!user){\r\n        return <div>Loading...</div>\r\n    }\r\n    return <div className=\"search\">\r\n        <IoMdClose color=\"red\" size=\"24px\" onClick={()=>setSearchToggle(false)}/>\r\n        {users.map(person=>{\r\n            return <div className=\"single-user\">\r\n            <span onClick={()=>window.location=\"/profile/\"+person._id}>\r\n                <img src={person.profilePhoto} alt=\"profile\"/>\r\n                <h4>{person.username}</h4>\r\n            </span>\r\n\r\n           {!user.following.find(flw=>flw===person._id)?<button id=\"follow-btn\" onClick={()=>follow(person._id)}>FOLLOW</button>:\r\n           <button id=\"unfollow-btn\" onClick={()=>unfollow(person._id)}>UNFOLLOW</button>}\r\n        </div>\r\n        })}\r\n        \r\n    </div>\r\n}"]},"metadata":{},"sourceType":"module"}